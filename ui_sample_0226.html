<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=shift_jis">
<base target=main>

<script src="http://code.jquery.com/jquery-1.12.0.min.js"></script>
<script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>
<link rel="stylesheet" href="/resources/demos/style.css" />
<link rel="stylesheet" href="http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css" />

<title>検査母数</title>
</head>
<script>

//9999/99/99 or 9999-99-99 の型チェック 
function IsDateType(dateVal){
//http://www.megasoft.co.jp/mifes/seiki/
	var validatePattern = /^(\d{4})(\/|-)(\d{1,2})(\/|-)(\d{1,2})$/;
	return validatePattern.test(dateVal);//True or False
}

//現在日付をを設定
function getCurrentDate(){
	now = new Date();
	y = now.getFullYear();
	m = now.getMonth() + 1;
	d = now.getDate();
	return (y + '/' + m + '/' + d);
}

function splitString (stringToSplit, separator) {
	var arrayOfStrings = [] ;
	arrayOfStrings = stringToSplit.split(separator);
	
	//for (var i = 0; i < arrayOfStrings.length; i++) {
	//	print(arrayOfStrings[i] + " / ");
	//}
	//console.log(arrayOfStrings);
	//console.log(arrayOfStrings[0]);
	return arrayOfStrings;
 
}

function showMsg( id, msgTest, bgColor,  fontColor ){
	$("" + id + "").text( msgTest );
	$("" + id + "").css("background-color", bgColor ).css("color", fontColor);
}

function validateDateFromTo(dateFrom,  dateTo){
	//alert("validateDateFromTo")
	//スラッシュを分割
	var dateFromArr=[],  dateToArr=[];
	var separator = "/";
	dateFromArr = splitString(dateFrom, separator);
	for (var i= 0; i < dateFromArr.length ; i++){
		console.log(dateFromArr[i]);
	}
	
	dateToArr = splitString(dateTo, separator);
	for (var i= 0; i < dateToArr.length ; i++){
		console.log(dateToArr[i]);
	}
	
	//dateFromArr = dateFrom.split("/", 3);
	//dateToArr   = dateTo.split("/", 3);
	
	//連想配列に格納
	var objDateFrom   = {};
	objDateFrom.year  = dateFromArr[0] ;
	objDateFrom.month = dateFromArr[1] ;
	objDateFrom.day   = dateFromArr[2] ;
	
	var objDateTo   = {};
	objDateTo.year  = dateToArr[0] ;
	objDateTo.month = dateToArr[1] ;
	objDateTo.day   = dateToArr[2] ;
	//alert("ああああ")
	//年の大小
	if(!validateYearFromTo(objDateFrom.year, objDateTo.year)){
		showMsg("#msg", "NG Year [From>To]",  "white",  "red");
		return false;
		
		////月の大小
		if(!validateMonthFromTo(objDateFrom.month, objDateTo.month )){
			showMsg("#msg", "NG Month [From>To]",  "white",  "red");
			return false;
		
			//日の判定

		
		}
		
	}else{
		console.log("Validation OK!");
		showMsg("#msg", "",  "white", "#006699" ,  "black");
		return true;
	
	}

}


function validateYearFromTo(dateFrom, dateTo, dateSwich  ){
	var yearFrom, yearTo;
	var dateFromArr, dateToArr;
	dateSwich = typeof dateSwich == 'undefined' ?  false : dateSwich; 
	 
	
	if(dateSwich === true){
	// 9999/99/99でを想定
		yearFrom = dateFrom.s(0,4);
		yearTo   = dateTo.substr(0,4);
	}else{
	//9999を想定
		yearFrom = dateFrom;
		yearTo   = dateTo;
	}
	
	//判定
	if(yearFrom > yearTo){
		//alert("false")
		return false ;
	}else{
		return true;
	}
}

function validateMonthFromTo(dateFrom, dateTo){
	var monthFrom=[], monthTo=[];
	monthFrom = dateFrom.split("/", 2);
	monthTo   = dateTo.split("/", 2 );
	alert(monthFrom[1]);
	alert(monthTo[1]);
	if(monthFrom[1] > monthTo[1]){
		return false;
	}else{
		return true;
	}
}


function validateDayFromTo(dateFrom, dateTo){

}
$(function() {
	//HTMLの初期値を設定
	//alert(getCurrentDate());
	
	//alert(splitString(getCurrentDate()))
	var retVal = splitString(getCurrentDate(), "/");
	console.log(retVal[0]);
	
	$("input[name=txtShipFrom]").val(getCurrentDate());
	$("input[name=txtShipTo]").val(getCurrentDate());
	$("select[name=cmbYear]").val("2016");
	//focusの初期設定
	$("input[name=cmdFind]").focus();
	
	//jQuery UIのdatepickerを設定
	$("input[name=txtShipFrom]").datepicker({
		dateFormat: 'yy/mm/dd'
	});
	$("input[name=txtShipTo]").datepicker({
		dateFormat: 'yy/mm/dd'
	});
	$("input[name=cmdFind]").on('click', function(){
		//validation
		//http://webrewrite.com/validate-date-format-yyyymmdd-javascript/
		
		//validation
		//YearFrom
		var dateFrom = $("input[name=txtShipFrom]").val();
		var dateTo = $("input[name=txtShipTo]").val();
		
		if(!validateDateFromTo( dateFrom , dateTo)){
			//alert("NG")
			return false;
		}else{
			//alert("ok")
		
		
		}
		
	//	if(!IsDateType(dateFrom)){
	//		//alert("日付は、9999/99/99ですよ");
	//		$("#msg").text("日付[From]は、9999/99/99で入力してください。");
	//		$("#msg").css("background-color","white").css("color","red");
	//		$("input[name=txtShipFrom]").css("background-color","red");
	//		//$("input[name=txtShipFrom]").append("<div>aaaaaaaaaaaaa</div>");
	//		return false;	
	//	}else{
	//		$("#msg").text("");
	//		
	//	}
	//	//YearTo
	//	if(!IsDateType(dateTo)){
	//		//alert("日付は、9999/99/99ですよ");
	//		$("#msg").text("日付[From]は、9999/99/99で入力してください。");
	//		$("#msg").css("background-color","white").css("color","red");
	//		$("input[name=txtShipTo]").css("background-color","red");
	//		//$("input[name=txtShipFrom]").append("<div>aaaaaaaaaaaaa</div>");
	//		return false;	
	//	}else{
	//		$("#msg").text("");
	//	}
	//	
	//	
	//	//日付FromToチェック
	//	//年の大小
	//	if(!validateYearFromTo(dateFrom,dateTo)){
	//		//alert("From>To Year");
	//		$("#msg").text("日付がFrom>Toになっています。");
	//		$("#msg").css("background-color","white").css("color","red");
	//		return false;
	//	}else{
	//		$("#msg").text("");
	//	
	//	}
	//	//月の大小
	//	if(!validateMonthFromTo(dateFrom,dateTo)){
	//		$("#msg").text("日付がFrom>Toになっています。");
	//		$("#msg").css("background-color","white").css("color","red");
	//		return false;
	//	}else{
	//		$("#msg").text("");
	//	}
	//	//日の大小
	//	
		////Ok	
		$(this).val("ボタン押しました！");
		$(this).css("background-color","#FFFF00");
		$(this).prop("disabled", true);

		
		
	});
 });
 
</script>
<style>
    .ui-datepicker {
        font-size: 50%;
    }
	#msg{
	/*
		width:150px;
	*/
	}
</style>
<body bgcolor="#006699">

<form method=GET action="make_qc_qty_insreports.cgi">

<!--
<form method=GET action="">
-->
	<h3><font color="#FFFFFF">検査母数</font> </h3>
	<p><font color=#FFFFFF>検査完了日</font> </p>
    <p align=center><input type=text name=txtShipFrom size=20><font color="#FFFFFF"><br>
    (例) 2004/01/01</font></p>      
    <p align=center><input type=text name=txtShipTo size=20><font color="#FFFFFF">
    <br>(例) 2004/01/01</font></p>     
    <p align=center><select size="1" name="cmbYear">
      <option value="2004">2004</option>
      <option value="2005">2005</option>
      <option value="2006">2006</option>
      <option value="2007">2007</option>
      <option value="2008">2008</option>
      <option value="2009">2009</option>
      <option value="2010">2010</option>
      <option value="2011">2011</option>
      <option value="2012">2012</option>
      <option value="2013">2013</option>
      <option value="2014">2014</option>
      <option value="2015">2015</option>
      <option value="2016">2016</option>
      <option value="2017">2017</option>
      <option value="2018">2018</option>
      <option value="2019">2019</option>
      <option value="2020">2020</option>
    </select></p> 
    <p align=center><select size="1" name="cmbMonth">
      <option value="01">1:Jan.</option>
      <option value="02">2:Feb.</option>
      <option value="03">3:Mar.</option>
      <option value="04">4:Apr.</option>
      <option value="05">5:May.</option>
      <option value="06">6:Jun.</option>
      <option value="07">7:Jul.</option>
      <option value="08">8:Aug.</option>
      <option value="09">9:Sep.</option>
      <option value="10">10:Oct.</option>
      <option value="11">11:Nov.</option>
      <option value="12">12:Dec.</option>
    </select></p> 
    <p align=center><select size="1" name="cmbWeek">
      <option value="1">Week1</option>
      <option value="2">Week2</option>
      <option value="3">Week3</option>
      <option value="4">Week4</option>
      <option value="5">Week5</option>
    </select></p>
    <p><font color="#FFFFFF">Mail宛先</font></p>
    <p align="center"><input type="text" name="txtMail" size="20"></p>
	<p align=center><input type=submit value=OK name=cmdFind>
	<div id="msg">

	</div>
</form>
</body>
</html>
