<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<base target=main>

<script src="http://code.jquery.com/jquery-1.12.0.min.js"></script>
<script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>
<link rel="stylesheet" href="/resources/demos/style.css" />
<link rel="stylesheet" href="http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css" />

<title>datechecker(sample)</title>
</head>
<script>
//http://semooh.jp/jquery/api/events/keydown/fn/
//ã‚­ãƒ¼ã‚³ãƒ¼ãƒ‰

//http://www.dab.hi-ho.ne.jp/sasa/biboroku/javascript/prototype.html
function PrtDate(){
	this.year;
	this.month;
	this.day;
};
PrtDate.prototype.show = function(){
	alert("year:" + this.year + "month:" + this.month + "day:" + this.day);
	
}
//function PrtDate(){
//	PrtDate.prototype.year;
//	PrtDate.prototype.month;
//	PrtDate.prototype.day;
//	PrtDate.prototype.show = function(){
//		alert("year:" + this.year + "month:" + this.month + "day:" + this.day);
//		
//	}
//};

function IsDateType(dateVal){
//http://www.megasoft.co.jp/mifes/seiki/
	var validatePattern = /^(\d{4})(\/|-)(\d{1,2})(\/|-)(\d{1,2})$/;
	return validatePattern.test(dateVal);//True or False
}

function getCurrentDate(){
	now = new Date();
	y = now.getFullYear();
	m = now.getMonth() + 1;
	d = now.getDate();
	return (y + '/' + m + '/' + d);
}

function splitString (stringToSplit, separator) {
	var arrayOfStrings = [] ;
	arrayOfStrings = stringToSplit.split(separator);
	//for (var i = 0; i < arrayOfStrings.length; i++) {
	//	print(arrayOfStrings[i] + " / ");
	//}
	//console.log(arrayOfStrings);
	//console.log(arrayOfStrings[0]);
	return arrayOfStrings;
 
}

function showMsg( id, msgTest, bgColor,  fontColor ){
	$("" + id + "").text( msgTest );
	$("" + id + "").css("background-color", bgColor ).css("color", fontColor);
}

function validateDateFromTo(dateFrom,  dateTo){
	var dateFromArr=[],  dateToArr=[];
	var separator = "/";
	dateFromArr = splitString(dateFrom, separator);
	for (var i= 0; i < dateFromArr.length ; i++){
		console.log(dateFromArr[i]);
	}
	
	dateToArr = splitString(dateTo, separator);
	for (var i= 0; i < dateToArr.length ; i++){
		console.log(dateToArr[i]);
	}
	
	//dateFromArr = dateFrom.split("/", 3);
	//dateToArr   = dateTo.split("/", 3);
	
	var objDateFrom   = {};
	objDateFrom.year  = dateFromArr[0] ;
	objDateFrom.month = dateFromArr[1] ;
	objDateFrom.day   = dateFromArr[2] ;
	
	var objDateTo   = {};
	objDateTo.year  = dateToArr[0] ;
	objDateTo.month = dateToArr[1] ;
	objDateTo.day   = dateToArr[2] ;

	if(!validateYearFromTo(objDateFrom.year, objDateTo.year)){
		showMsg("#msg", "NG Year [From>To]",  "white",  "red");
		return false;
				
	}else{
		if(!validateMonthFromTo(objDateFrom.month, objDateTo.month )){
			showMsg("#msg", "NG Month [From>To]",  "white",  "red");
			return false;
		
		}else{
			if(!validateDayFromTo(objDateFrom.day, objDateTo.day )){
				showMsg("#msg", "NG day [From>To]",  "white",  "red");
				return false;
			}else{
				return true;
			}
		
		}
	}

}


function validateYearFromTo(dateFrom, dateTo, dateSwich  ){
	var yearFrom, yearTo;
	var dateFromArr, dateToArr;
	dateSwich = typeof dateSwich == 'undefined' ?  false : dateSwich; 
	 
	
	if(dateSwich === true){
	// 9999/99/99ç¸ºE§ç¹§å‘ˆÎ¦è³ãƒ»
		yearFrom = dateFrom.s(0,4);
		yearTo   = dateTo.substr(0,4);
	}else{
	//9999ç¹§å‘ˆÎ¦è³ãƒ»
		yearFrom = dateFrom;
		yearTo   = dateTo;
	}
	
	if(yearFrom > yearTo){
		return false;
	}else{
		return true;
	}
}



function validateMonthFromTo(dateFrom, dateTo){
	// TODO:9999/99/99
	dateFrom = parseInt(dateFrom, 10 ); 
	dateTo = parseInt(dateTo, 10 ); 
	
	if(dateFrom  > dateTo ){
			return false;
		}else{
			return true;
	}
	//var monthFrom=[], monthTo=[];
	//monthFrom = dateFrom.split("/", 2);
	//monthTo   = dateTo.split("/", 2 );
	//1=>01 , 2=>02
	//if(monthFrom[1].length==1){
	//	monthFrom[1] = "0" + monthFrom[1];
	//}
	//
	//if(monthTo[1].length==1){
	//	monthTo[1] = "0" + monthTo[1];
	//}
	
//	var re = /^[0]/gi; 
//	var found = dateFrom.match(re); 
//	console.log(found);
	//alert(found)
	
//	if (found===null){
//		if(monthFrom[1] > monthTo[1]){
//			return false;
//		}else{
//			return true;
//		}
//	}else{
//		
//		
//	}
//	alert(monthFrom[1]);
//	alert(monthFrom[1], 10);
//	monthFrom[1]=parseInt(monthFrom[1], 10);
//	monthTo[1]=parseInt(monthTo[1], 10);
//	
//	
//	if(monthFrom[1] > monthTo[1]){
//			return false;
//		}else{
//			return true;
//	}
}

function validateDayFromTo(dateFrom, dateTo){
	// TODO:9999/99/99
	dateFrom = parseInt(dateFrom, 10 ); 
	dateTo = parseInt(dateTo, 10 ); 
	
	if(dateFrom  > dateTo ){
			return false;
		}else{
			return true;
	}


	//var dayFrom=[], dayTo=[];
	//dayFrom = dateFrom.split("/", 3 );
	//dayTo   = dateTo.split("/", 3 );
	//
	//if(dayFrom[2] > dayTo[2]){
	//	return false;
	//}else{
	//	return true;
	//}
}

function isLeapYear(dateVal){
	var arrDate=[];
	arrDate = dateVal.split("/", 3 );
	dateVal = arrDate[2];
	
	//100ã§å‰²ã‚ŠåEã‚‹ã€€ã‹ã¤ã€€400ã§å‰²ã‚ŠåEã‚Œã‚‹ã€€=> Leap Year
	
	//
	//4ã§å‰²ã‚ŠåEã‚Œã‚‹å¹´ã¯é–å¹´ã§ã‚ã‚‹ã€‚ãŸã ãE00ã§å‰²ã‚ŠåEã‚Œã‚‹å¹´ã¯é–å¹´ã§ã¯ãªãE€‚ãŸã ãE00ã§å‰²ã‚ŠåEã‚Œã‚‹å¹´ã¯é–å¹´
	//ãŸã ãE00ã§å‰²ã‚ŠåEã‚Œã‚‹å¹´ã¯é–å¹´ã§ã¯ãªãE€E
	//ãŸã ãE00ã§å‰²ã‚ŠåEã‚Œã‚‹å¹´ã¯é–å¹´
	if ( dateVal % 4 === 0){
		//4ã§å‰²ã‚ŠåEã‚Œã‚‹
		
		if(dateVal % 100 === 0 ){
		//100ã§å‰²ã‚ŠåEã‚Œã‚‹
			return false;
		}else{
		
			return true;
		}		
	}else{
		return false;
	}
	
	if ( dateVal % 400 === 0){
		return true;
	}else{
		return false;	
	}
}

$(function() {
	
	var objFromDate = new PrtDate();
	var objToDate = new PrtDate();
	
	//var objFromDate = new PrtDate();
	//var objToDate = new PrtDate();
	//
	//var arr = [];
	//arr = getCurrentDate().split("/",3);
	//objFromDate.year  = arr[0];
	//objFromDate.month = arr[1];
	//objFromDate.day   = arr[2];
	//objFromDate.show();
    //
    //
	//objToDate.year  = "2013";
	//objToDate.month = "1";
	//objToDate.day   = "12";
	//objToDate.show();

	//HTMLã®åˆæœŸå€¤ã‚’è¨­å®E
	//alert(getCurrentDate());
	$("input[name=txtShipFrom]").val(getCurrentDate());
	$("input[name=txtShipTo]").val(getCurrentDate());
	$("select[name=cmbYear]").val("2016");
	//focusã®åˆæœŸè¨­å®E
	$("input[name=cmdFind]").focus();
	
	$("input[name=txtShipFrom").keydown(function(e){
		//$(this).val(e.keyCode);
		//alert(e.keyCode)
		//â†‘ã‚­ãƒ¼(38)ã§ä¸€é€±é–“åˆ†
		
		if (e.keyCode === 38){
			var separator = "/";
			var dateFromArr= [];
			dateFromArr = splitString($("input[name=txtShipFrom]").val(), separator);
		
		     alert(dateFromArr)
		
		}
		
		
		return false;
    });

	$("input[name=txtShipFrom]").datepicker({
		dateFormat: 'yy/mm/dd'
	});
	$("input[name=txtShipTo]").datepicker({
		dateFormat: 'yy/mm/dd'
	});
	$("input[name=cmdFind]").on('click', function(){
		//validation
		//http://webrewrite.com/validate-date-format-yyyymmdd-javascript/
		
		//validation
		//YearFrom
		var dateFrom = $("input[name=txtShipFrom]").val();
		var dateTo = $("input[name=txtShipTo]").val();
		
		if(!validateDateFromTo( dateFrom , dateTo)){
			//alert("NG")
			return false;
		}else{
			//alert("ok")
		
		}

//
//		var tmpDay =[];
//		if(!isLeapYear(dateFrom)) 
//		{
//			tmpDay = dateFrom.split("/" ,  3)
//			if ( tmpDay[2] == 29 ){
//				alert("2/29 is not correct");
//			}
//			
//		}
//		if(!isLeapYear(dateTo))
//		{
//			alert("Leap Year")
//		}		
//		
		
		//Ok
		$(this).val("Submitted !");
		$(this).css("background-color","#FFFF00");
		$(this).prop("disabled", true);
		showMsg("#msg", "ã‚µãƒ¼ãƒãƒ¼ã¸é€ä¿¡ã—ã¾ã—ãŸï¼",  "white",  "red");
		
	});
 });
 
</script>
<style>
    .ui-datepicker {
        font-size: 50%;
    }
	#msg{
	/*
		width:150px;
	*/
	}
	.fontcolor{
			color:white;
	}
	.center{
		text-align:center;
	}
	.body-background-color{
		background-color:#006699
	}
</style>
<body class="body-background-color">

<form method=GET action="make_qc_qty_insreports.cgi">

<!--
<form method=GET action="">
-->

	<h3 class="fontcolor center">Validation Sample For Date</h3>
	<p  class="fontcolor center"></p>
    <p  class="fontcolor center">
		<input type=text name=txtShipFrom size=20><br>
		(From)2004/01/01
	</p>      
    <p  class="fontcolor center"><input type=text name=txtShipTo size=20>
		<br>(To)2004/01/01
	</p>     
    <p  class="center" >
	<select size="1" name="cmbYear">
      <option value="2004">2004</option>
      <option value="2005">2005</option>
      <option value="2006">2006</option>
      <option value="2007">2007</option>
      <option value="2008">2008</option>
      <option value="2009">2009</option>
      <option value="2010">2010</option>
      <option value="2011">2011</option>
      <option value="2012">2012</option>
      <option value="2013">2013</option>
      <option value="2014">2014</option>
      <option value="2015">2015</option>
      <option value="2016">2016</option>
      <option value="2017">2017</option>
      <option value="2018">2018</option>
      <option value="2019">2019</option>
      <option value="2020">2020</option>
    </select>
	</p> 
    <p align=center>
	<select size="1" name="cmbMonth">
      <option value="01">1:Jan.</option>
      <option value="02">2:Feb.</option>
      <option value="03">3:Mar.</option>
      <option value="04">4:Apr.</option>
      <option value="05">5:May.</option>
      <option value="06">6:Jun.</option>
      <option value="07">7:Jul.</option>
      <option value="08">8:Aug.</option>
      <option value="09">9:Sep.</option>
      <option value="10">10:Oct.</option>
      <option value="11">11:Nov.</option>
      <option value="12">12:Dec.</option>
    </select>
	</p> 
    <p class="center">
	<select size="1" name="cmbWeek">
      <option value="1">Week1</option>
      <option value="2">Week2</option>
      <option value="3">Week3</option>
      <option value="4">Week4</option>
      <option value="5">Week5</option>
    </select>
	</p>
	<!--
    <p><font color="#FFFFFF">Mail</font></p>
    <p align="center"><input type="text" name="txtMail" size="20"></p>
	-->
	<p align=center><input type=submit value=OK name=cmdFind>
	<div id="msg">
	</div>
</form>
</body>
</html>
